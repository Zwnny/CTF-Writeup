# JAM

**A challenge which we need to use hash length extension attack**

```python
import hashpumpy
from pwn import remote

r = remote('server.challenge.ctf.thefewchosen.com', '1343')
r.recvuntil(b'>')
r.sendline(b'5') # to get the hash of { secrete + ' ' + '0' }
token = r.recvline() # token = hash of { secrete + ' ' + '0' }
token = token.decode().strip()

for i in range(0,1000,1): # brute force to find length of {secrete} to do a hash length extension attack
    r.recvuntil(b'>')
    r.sendline(b'3') # To recover session
    r.recvuntil(b'>')
    payload, mess = hashpumpy.hashpump(token.encode(),b' 0',b'11',i) # can choose any number >= 6, but i just like the number 11 :v 
    # payload is the new hash from {secrete + b' ' + b'0' + padding + b'11'}
    # mess is ' 0{padding}11' 
    r.sendline(mess.strip()) # since i dont need the space character(" ") to be in mess(server will add ' ' to my input). i strip off the ' ' at the beginning of mess
    r.recvuntil(b'>')
    r.sendline(payload)
    response = r.recvline()
    if response == b'Recovered successfully!':
        r.recvuntil(b'>')
        r.sendline(b'2') # to TRADE
        r.recvuntil(b'>')
        r.sendline(b'1') # to BUY FLAG
        flag = r.recvline() #recover the flag
        print(flag)
        break
    print("Round: ",i)
    
r.close()
```
```Flags:TFCCTF{PUmP_up_th3_j4m,PUMP_17_up!h4shpump_it!}```
<br>
# AM I DOING IT RIGHT?
**Basic RSA with n = p\*q, where p = q** <br>

```Flags:TFCCTF{1_w0n7_4dm1t_h0w_l0ng_th1s_t00k_4_me...congrats,tho!} ```

# KH5YHLZVJP
**Exloit Mersenne Twister pseudorandom number generator**
```python
from pwn import remote,xor
from mt19937predictor import MT19937Predictor
import base64
#arr is the 4 numbers from c.out
arr = [   708566309217632041169061421395669545839486077225372152489626794715120680793684532732078727536638348797432185902935714974420709282888710131992497398728142562166706095874104677820222194785902042889975837035624578589183410997122667837073593108422921296536326348982754543696649470491234577203285918927766071407147806755543876058951629992067676484184025684994470751563833474039662552894672785186223418406271643711441572445531878212068144716745376550344782775642911350398444061175847691419539851775388040124836694707097951395414635337380345504915144995322549545588942899652827001133114625189218485105091478781790540352654488538816210127122165609420034867779126930759536878803498710912754349536035020742646653722728756485393936678035370483505917709433793670293259715757817391262704798114380278332641907300453095282212443593020364912273081452430834094960919723929841990984454717995145003127276824369715705512194400026260127552488471254262779400876387494782316880554742275625054335694038419543554114074490245173620652256170113782577592048981039935166419510106476339060508064175906095352581450387832095319382460364892706836280520116256708995249659035348607076601130764721747135347510056976917681359960458929688871761489225088173975354621983380,
751502420947278735407300980912172433133312841973568519590428163204419766748081978731808367670765936466905829953934066550919847771726605136763197384245939284364787936402981304539232648723999003088307564286295009456199294117410672778872388634836190919689995108386672334624877740895197483472629279093860949046588283435641626587748679240455506885715749143695204330179016258343868402209422043024975232260723787496893328863062635024862682878071815913991888868229517343526164820335470611559702999229717972745731452025225299781765225938826308865955380821318461248499021770039961715749480838729167725812559706005457674510639541171655111486170111116648837425136781232686975487018459615884520318281632899223245639423326870200262207020966011232522503264687811710471626137923137439464614138749567891497485018021457876019531600444164169229836616408630348920226747082139128383105315576879706451819684974125099805992207866942268646722083405207550490868181997775060230210769945278621377090892589986714133944810007961445868578258191757870067178715023955522287241392815931991989825808796283813547262353516046548519935434673536648343199621621844701614167242515683756245981418748148887863129532102278882920288725892500194281195500244253642427368823579375,
669051478168133094273429904533679194456509718199340045733420990917781407478955651441353477333019638815962856086433860431726725598906032981044832849240981163185014744396052585804520841989466796026919496631837777064988407396641679040783260955652934514811453252291059072597516973218993352681503958841111180736322617917084077827260274233927577118196087837377439995105279299756466639976783667421675085005196511419751509339570934044526637392555480170518849957846130906294665384061729206873858148382100911698925721738917558947627930278997101112916877286686205035288685721162943359357214640496463007059262280141332875700611161202637805919830981199473266264913348877949091063599837209075879740806837710269983919905395901426155617117791858792102816115143732367760910405660369765057055801288907517261658258693063340948545258908472841531597273651477236516021879405781435611376595424672023998022219469619349598080696878031538187491345699474293738550704186758483141881487601473855823121335411014083117782287482973091148456716690161208898425307858011208096373219093182851570379513981690137569185874421108111285073252585808018954255640640521619564349005022348325204443533174580543853517019515017897689161610459741199842599504542525906007363846073139,
290525118214789725529068732430637869018988663137348393212864294916779565440260180780930308639394791476032285357490697345552623104836752123670677562961619095447361422142332425469124457114283330767102450397030931541728281898560967861335668002207761224580297459154546319431706411513898259038656198840423637505825248181552798789354300279719227565500823793971895436988656487690508785030999905412092694003037275777188096613598655366290662051864431014004804259587171035716734649976472817986653911057882996240793480269212941438175612117107763010259526549651750975091322462195383489991557817863531184784307919796937617937840072585143040371375529823787905218577346014275330022440382793742868775703273465501614778040879964665406390390907818689028718309027684711999386666843226334923982136548236506074444865182069848029072149204919730589796338834314817770726722148602134449285237170729490061346234993945248246198990663208642102468005501973527717370347001058623308520864383288357378976250249051229978989733409818175527039074895728382976085396513045449345014861635479633329419240191374072217811601677885712695561618542677063747624708002936702088072527877789453374676025416650681589335779888138558662795297118311827755895843698997128802621605996494
]
SECRET = 'YHR6cGxwSQBYBQFRTUoFbUZaUGsIA2lEUAMbUAVFXFIMX10eawJTbl4DWExqBUdJARhXAlRaB0RqUkdfVF9cR0BNYHNxcWB2TQhWBwtSQUcDaUVcU2kBBmpBXAsfUgdGWVQHWl0VaAdeal4AWE9mBEhFDBlUCFtbBUVoUkpbVFhTQk1OYHNzcWZwTwJcAgZUR0AAaUReV2gFB21AUAAbUQRAWF8NXl4daQRTbF0BXkxpBUNCBBxXCFRdAUFtX0RXVVxcQU9KZXZycm11SABfBQNQQUMBZkteVWYCBG1AXgYUVQhAX1MEWVQZbAVWZl0MX0pvBEZADR1fB19bAURnUEdXUFxUTEtOZH9zdmVxTARaDAFWR0ULZ0tXVWwCA2xNXwIfVwBEX1YBVVoeaQheaVkEWE5oA0ZJBB5fBl1ZBkBsV0JXVVxUQUFNYHFyemZwTwBfBQBTR0AFbEBcX2sIAWhFWAcbXQdEWVcMWFwfbABfaFgHWUFmAEVABh5fBllUAENpXkZZUFBXQU1EbXF2c2NzSAdfAAdaR0YHaURXX2wDAGZFXAsVUgBDX18EXVofbwRSZ14AWE1qBERCBxpXCF5bB0BoVkFXWlhWRktIYXJwd21+QwheDAVaQ0MCb0NdU2gFAGZBWAIcVgRAWFcAVFUbZwFTZlkAVkxsBEhIARg='
r = MT19937Predictor()
ct = base64.b64decode(SECRET)
for i in arr:
    r.setrandbits(i,4096)
x = r.getrandbits(4096)
print('FLAG:{}'.format(xor(ct,str(x)[:512])))
```
```FLAG: TFCCTF{1n53cur3_rng_15_th3-d0wnf4ll-_0f_m4ny_4pp5.f0ll0w_fsociety}```
